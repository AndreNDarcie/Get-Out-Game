<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    <h1>Dungeon Crawler</h1>
    <canvas id="canvas" width="200" height="200" style="background-color: #2ecc71;"></canvas>
    <p>W, A, S, D to move.</p>
    <p>Player position: <span id="status">s</span></p>
    <script src="js/object.js"></script>
    <script>
      var $canvas = document.getElementById('canvas');
      var context = $canvas.getContext("2d");

      // listen for keydown events on the document
      document.addEventListener("keydown",handleKeydown,false);

      var map = [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 1, 0, 0, 0, 0, 0, 0, 0, 1],
        [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
        [1, 0, 0, 0, 1, 0, 0, 0, 0, 1],
        [1, 0, 0, 0, 0, 1, 0, 0, 0, 1],
        [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
        [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
        [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
        [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
      ];

      var player = new Object({
        type: '',
        row: 1,
        column: 1,
        color: '',
        layer: map
      });

      draw();

      function draw(){

        context.clearRect(0,0,$canvas.width,$canvas.height);

        for (var row = 0; row < 10; row++){
          for (var column = 0; column < 10; column++){
            if(map[row][column] > 0){
              context.fillStyle = "#7f8c8d";
              context.fillRect(column * 20, row * 20, 20, 20);
            }
          }
        }

        document.getElementById('status').innerHTML =
                "[ column: " + player.column + ", row: " + player.row + " ]";

      }

      function handleKeydown(e){
        switch(e.keyCode){
          case 87: // W
            if (map[player.row-1][player.column] === 1){
              console.log("blocked");
            } else {
              player.moveUp();
            }
          break;
          case 83: // S
            if (map[player.row+1][player.column] === 1){
              console.log("blocked");
            } else {
              player.moveDown();
            }
          break;
          case 65: // A
            if (map[player.row][player.column-1] === 1){
              console.log("blocked");
            } else {
              player.moveLeft();
            }
          break;
          case 68: // D
            if (map[player.row][player.column+1] === 1){
              console.log("blocked");
            } else {
              player.moveRight();
            }
          break;
        }
        draw();
      }
    </script>
  </body>
</html>
